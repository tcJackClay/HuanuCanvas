# HuanuCanvas éƒ¨ç½²é…ç½®æ–¹æ¡ˆæ€»ç»“

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**HuanuCanvas** æ˜¯ä¸€ä¸ªåŸºäº React 19 + Vite + Node.js + Electron çš„å…¨æ ˆ AI å›¾åƒåˆ›æ„ç®¡ç†åº”ç”¨ï¼Œé›†æˆ Google Gemini APIï¼Œæ”¯æŒèŠ‚ç‚¹å¼ç”»å¸ƒç¼–è¾‘å™¨ã€‚

### æŠ€æœ¯æ ˆ
- **å‰ç«¯**: React 19 + Vite + TypeScript
- **åç«¯**: Node.js + Express
- **æ¡Œé¢åº”ç”¨**: Electron
- **AIé›†æˆ**: Google Gemini API
- **æ•°æ®åº“**: PostgreSQL + Redis (å¯é€‰)
- **éƒ¨ç½²**: Docker + Kubernetes

---

## ğŸ—ï¸ éƒ¨ç½²æ¶æ„

### å¤šç¯å¢ƒæ”¯æŒ
```
å¼€å‘ç¯å¢ƒ (development) â†’ æµ‹è¯•ç¯å¢ƒ (staging) â†’ ç”Ÿäº§ç¯å¢ƒ (production)
```

### æœåŠ¡æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Load Balancer â”‚    â”‚   Load Balancer â”‚    â”‚   Load Balancer â”‚
â”‚   (Traefik/Nginx)â”‚    â”‚   (Traefik/Nginx)â”‚    â”‚   (Traefik/Nginx)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend      â”‚    â”‚   Frontend     â”‚    â”‚   Frontend     â”‚
â”‚   (React+Nginx)â”‚    â”‚   (React+Nginx)â”‚    â”‚   (React+Nginx)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Backend       â”‚    â”‚   Backend      â”‚    â”‚   Backend      â”‚
â”‚   (Node.js)     â”‚    â”‚   (Node.js)    â”‚    â”‚   (Node.js)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Database      â”‚    â”‚   Database     â”‚    â”‚   Database     â”‚
â”‚   PostgreSQL    â”‚    â”‚   PostgreSQL   â”‚    â”‚   PostgreSQL   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ é…ç½®æ–‡ä»¶ç»“æ„

```
deployment/
â”œâ”€â”€ .env.template                 # é€šç”¨ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .env.development              # å¼€å‘ç¯å¢ƒé…ç½®
â”œâ”€â”€ .env.staging                  # æµ‹è¯•ç¯å¢ƒé…ç½®
â”œâ”€â”€ .env.production               # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ docker-compose.yml            # å¤šç¯å¢ƒDocker Compose
â”œâ”€â”€ k8s-production.yaml           # Kubernetesç”Ÿäº§é…ç½®
â”œâ”€â”€ Dockerfile.frontend           # å‰ç«¯Dockeré•œåƒ
â”œâ”€â”€ Dockerfile.backend           # åç«¯Dockeré•œåƒ
â”œâ”€â”€ nginx.conf                    # Nginxé…ç½®
â”œâ”€â”€ monitoring/
â”‚   â”œâ”€â”€ prometheus.yml            # Prometheusç›‘æ§é…ç½®
â”‚   â”œâ”€â”€ alert-rules.yml           # å‘Šè­¦è§„åˆ™
â”‚   â””â”€â”€ grafana/                 # Grafanaä»ªè¡¨æ¿é…ç½®
â””â”€â”€ scripts/
    â”œâ”€â”€ health-check.sh          # å¥åº·æ£€æŸ¥è„šæœ¬
    â”œâ”€â”€ backup.sh                # å¤‡ä»½è„šæœ¬
    â”œâ”€â”€ deploy.sh                # éƒ¨ç½²è„šæœ¬
    â””â”€â”€ maintenance.sh           # ç»´æŠ¤è„šæœ¬
```

---

## ğŸ”§ æ ¸å¿ƒé…ç½®ä¼˜åŒ–

### 1. Docker Compose å¤šç¯å¢ƒé…ç½®

**ç‰¹æ€§**:
- ç¯å¢ƒéš”ç¦» (development/staging/production)
- æœåŠ¡ä¾èµ–ç®¡ç†
- å¥åº·æ£€æŸ¥
- æ—¥å¿—èšåˆ
- ç›‘æ§é›†æˆ
- è‡ªåŠ¨é‡å¯ç­–ç•¥

**ä¸»è¦æœåŠ¡**:
- `frontend`: Reactå‰ç«¯ + Nginx
- `backend`: Node.js APIæœåŠ¡
- `redis`: ç¼“å­˜æœåŠ¡
- `postgres`: æ•°æ®åº“æœåŠ¡
- `prometheus`: ç›‘æ§æ”¶é›†
- `grafana`: ç›‘æ§é¢æ¿

### 2. ç¯å¢ƒå˜é‡ç®¡ç†

**é…ç½®å±‚æ¬¡**:
1. **åŸºç¡€é…ç½®**: åº”ç”¨ä¿¡æ¯ã€ç«¯å£è®¾ç½®
2. **ç¯å¢ƒé…ç½®**: å¼€å‘/æµ‹è¯•/ç”Ÿäº§ç‰¹å®šè®¾ç½®
3. **å¯†é’¥é…ç½®**: APIå¯†é’¥ã€å®‰å…¨å¯†é’¥
4. **æ€§èƒ½é…ç½®**: èµ„æºé™åˆ¶ã€å¹¶å‘è®¾ç½®
5. **å¤–éƒ¨æœåŠ¡**: æ•°æ®åº“ã€ç¼“å­˜ã€ç›‘æ§

**å¯†é’¥ç®¡ç†**:
- `GEMINI_API_KEY`: Google Gemini APIå¯†é’¥
- `JWT_SECRET`: JWTä»¤ç‰Œå¯†é’¥
- `SESSION_SECRET`: ä¼šè¯å¯†é’¥
- `DATABASE_URL`: æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²

### 3. CI/CD æµæ°´çº¿

**GitHub Actions å·¥ä½œæµ**:
1. **ä»£ç è´¨é‡æ£€æŸ¥**: Lintã€ç±»å‹æ£€æŸ¥ã€å®‰å…¨æ‰«æ
2. **æµ‹è¯•å¥—ä»¶**: å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€E2Eæµ‹è¯•
3. **æ„å»ºé˜¶æ®µ**: å‰ç«¯/åç«¯é•œåƒæ„å»º
4. **å®‰å…¨æ‰«æ**: Trivyæ¼æ´æ‰«æã€SonarQubeä»£ç è´¨é‡
5. **éƒ¨ç½²æµç¨‹**: è‡ªåŠ¨åŒ–éƒ¨ç½²åˆ°æµ‹è¯•/ç”Ÿäº§ç¯å¢ƒ
6. **åç½®éªŒè¯**: å¥åº·æ£€æŸ¥ã€åŠŸèƒ½éªŒè¯

**éƒ¨ç½²ç­–ç•¥**:
- è“ç»¿éƒ¨ç½² (ç”Ÿäº§ç¯å¢ƒ)
- æ»šåŠ¨æ›´æ–° (Kubernetes)
- å›æ»šæœºåˆ¶
- å¥åº·æ£€æŸ¥é—¨ç¦

### 4. Kubernetes ç”Ÿäº§é…ç½®

**é«˜å¯ç”¨ç‰¹æ€§**:
- å¤šå‰¯æœ¬éƒ¨ç½²
- è‡ªåŠ¨æ‰©ç¼©å®¹ (HPA)
- æ»šåŠ¨æ›´æ–°ç­–ç•¥
- PodDisruptionBudget
- NetworkPolicy å®‰å…¨ç­–ç•¥

**ç›‘æ§é›†æˆ**:
- ServiceMonitor
- Prometheus Operator
- è‡ªå®šä¹‰æŒ‡æ ‡
- å‘Šè­¦è§„åˆ™

### 5. ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ

**ç›‘æ§æ ˆ**:
- **Prometheus**: æŒ‡æ ‡æ”¶é›†
- **Grafana**: å¯è§†åŒ–é¢æ¿
- **Jaeger**: åˆ†å¸ƒå¼è¿½è¸ª
- **Loki**: æ—¥å¿—èšåˆ
- **AlertManager**: å‘Šè­¦ç®¡ç†

**æ ¸å¿ƒæŒ‡æ ‡**:
- åº”ç”¨æ€§èƒ½ (å“åº”æ—¶é—´ã€é”™è¯¯ç‡)
- èµ„æºä½¿ç”¨ (CPUã€å†…å­˜ã€ç£ç›˜)
- ä¸šåŠ¡æŒ‡æ ‡ (AI APIè°ƒç”¨ã€ç”¨æˆ·ä¼šè¯)
- åŸºç¡€è®¾æ–½ (å®¹å™¨çŠ¶æ€ã€ç½‘ç»œ)

**å‘Šè­¦çº§åˆ«**:
- **Critical**: æœåŠ¡å®•æœºã€é”™è¯¯ç‡è¿‡é«˜
- **Warning**: æ€§èƒ½ä¸‹é™ã€èµ„æºä¸è¶³
- **Info**: ä¸šåŠ¡å¼‚å¸¸ã€é…ç½®å˜æ›´

---

## ğŸš€ éƒ¨ç½²æµç¨‹

### å¼€å‘ç¯å¢ƒ
```bash
# 1. å¤åˆ¶ç¯å¢ƒé…ç½®
cp deployment/.env.development .env.development.local

# 2. å¯åŠ¨å¼€å‘ç¯å¢ƒ
docker-compose -f deployment/docker-compose.yml --env-file .env.development.local up -d

# 3. è¿è¡Œå¥åº·æ£€æŸ¥
./deployment/scripts/health-check.sh development
```

### æµ‹è¯•ç¯å¢ƒ
```bash
# 1. é…ç½®ç¯å¢ƒå˜é‡
cp deployment/.env.staging .env.staging.local

# 2. éƒ¨ç½²åˆ°æµ‹è¯•æœåŠ¡å™¨
./deployment/scripts/deploy.sh staging

# 3. è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•
npm run test:integration
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
# 1. æ‰‹åŠ¨è§¦å‘CI/CDéƒ¨ç½²
# GitHub Actions â†’ deploy-production

# 2. Kuberneteséƒ¨ç½²
kubectl apply -f deployment/k8s-production.yaml

# 3. éªŒè¯éƒ¨ç½²
./deployment/scripts/health-check.sh production
```

---

## ğŸ”’ å®‰å…¨é…ç½®

### ç½‘ç»œå®‰å…¨
- TLS/SSLåŠ å¯†
- HTTPSå¼ºåˆ¶é‡å®šå‘
- å®‰å…¨å¤´è®¾ç½® (HSTS, CSP)
- CORSé…ç½®
- NetworkPolicyé™åˆ¶

### åº”ç”¨å®‰å…¨
- APIå¯†é’¥ç®¡ç†
- JWTä»¤ç‰Œè®¤è¯
- ä¼šè¯ç®¡ç†
- é€Ÿç‡é™åˆ¶
- è¾“å…¥éªŒè¯

### å®¹å™¨å®‰å…¨
- érootç”¨æˆ·è¿è¡Œ
- åªè¯»æ–‡ä»¶ç³»ç»Ÿ
- æœ€å°æƒé™åŸåˆ™
- é•œåƒæ‰«æ
- ç§˜å¯†ç®¡ç†

---

## ğŸ“Š ç›‘æ§é¢æ¿

### Grafana ä»ªè¡¨æ¿
1. **æ¦‚è§ˆé¢æ¿**: æœåŠ¡çŠ¶æ€ã€å…³é”®æŒ‡æ ‡
2. **åº”ç”¨æ€§èƒ½**: å“åº”æ—¶é—´ã€ååé‡ã€é”™è¯¯ç‡
3. **èµ„æºç›‘æ§**: CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œ
4. **ä¸šåŠ¡æŒ‡æ ‡**: AI APIè°ƒç”¨ã€ç”¨æˆ·æ´»åŠ¨
5. **æ—¥å¿—åˆ†æ**: é”™è¯¯æ—¥å¿—ã€è®¿é—®æ—¥å¿—

### å‘Šè­¦è§„åˆ™
- æœåŠ¡å¯ç”¨æ€§ç›‘æ§
- æ€§èƒ½é˜ˆå€¼å‘Šè­¦
- èµ„æºä½¿ç”¨å‘Šè­¦
- ä¸šåŠ¡å¼‚å¸¸å‘Šè­¦
- å®‰å…¨äº‹ä»¶å‘Šè­¦

---

## ğŸ’¾ å¤‡ä»½ç­–ç•¥

### æ•°æ®å¤‡ä»½
- **æ•°æ®åº“**: PostgreSQLå®šæ—¶å¤‡ä»½
- **æ•°æ®å·**: Dockerå·å¤‡ä»½
- **é…ç½®æ–‡ä»¶**: ç‰ˆæœ¬æ§åˆ¶+å¤‡ä»½
- **SSLè¯ä¹¦**: è‡ªåŠ¨ç»­æœŸ+å¤‡ä»½

### å¤‡ä»½ä¿ç•™
- **å¼€å‘ç¯å¢ƒ**: 7å¤©
- **æµ‹è¯•ç¯å¢ƒ**: 30å¤©
- **ç”Ÿäº§ç¯å¢ƒ**: 90å¤©
- **å¼‚åœ°å¤‡ä»½**: AWS S3

### æ¢å¤æµç¨‹
1. åœæ­¢æœåŠ¡
2. æ¢å¤æ•°æ®
3. éªŒè¯å®Œæ•´æ€§
4. å¯åŠ¨æœåŠ¡
5. å¥åº·æ£€æŸ¥

---

## ğŸ› ï¸ è¿ç»´å·¥å…·

### éƒ¨ç½²è„šæœ¬
- `deploy.sh`: è‡ªåŠ¨åŒ–éƒ¨ç½²
- `health-check.sh`: å¥åº·æ£€æŸ¥
- `backup.sh`: æ•°æ®å¤‡ä»½
- `maintenance.sh`: ç»´æŠ¤æ“ä½œ

### ç›‘æ§å·¥å…·
- PrometheusæŒ‡æ ‡æ”¶é›†
- Grafanaå¯è§†åŒ–
- AlertManagerå‘Šè­¦
- æ—¥å¿—èšåˆåˆ†æ

### è°ƒè¯•å·¥å…·
- å®¹å™¨æ—¥å¿—æŸ¥çœ‹
- ç½‘ç»œè¯Šæ–­
- æ€§èƒ½åˆ†æ
- é”™è¯¯è¿½è¸ª

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### åº”ç”¨å±‚ä¼˜åŒ–
- ä»£ç åˆ†å‰² (React)
- èµ„æºå‹ç¼© (Vite)
- ç¼“å­˜ç­–ç•¥ (Redis)
- CDNåŠ é€Ÿ
- æ•°æ®åº“ä¼˜åŒ–

### åŸºç¡€è®¾æ–½ä¼˜åŒ–
- å®¹å™¨èµ„æºé™åˆ¶
- è‡ªåŠ¨æ‰©ç¼©å®¹
- è´Ÿè½½å‡è¡¡
- ç½‘ç»œä¼˜åŒ–
- å­˜å‚¨ä¼˜åŒ–

### ç›‘æ§æŒ‡æ ‡
- åº”ç”¨å“åº”æ—¶é—´ < 2s
- APIé”™è¯¯ç‡ < 1%
- ç³»ç»Ÿå¯ç”¨æ€§ > 99.9%
- CPUä½¿ç”¨ç‡ < 80%
- å†…å­˜ä½¿ç”¨ç‡ < 80%

---

## ğŸ”„ æ›´æ–°å’Œç»´æŠ¤

### ç‰ˆæœ¬æ›´æ–°
1. ä»£ç æäº¤ â†’ GitHub
2. CI/CDæµæ°´çº¿è§¦å‘
3. è‡ªåŠ¨æµ‹è¯•å’Œæ„å»º
4. éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
5. éªŒè¯é€šè¿‡ â†’ ç”Ÿäº§ç¯å¢ƒ
6. ç›‘æ§éªŒè¯

### ç»´æŠ¤çª—å£
- **è®¡åˆ’ç»´æŠ¤**: æ¯æœˆç¬¬ä¸€ä¸ªå‘¨æœ«
- **ç´§æ€¥ç»´æŠ¤**: 24å°æ—¶é€šçŸ¥
- **é›¶åœæœºéƒ¨ç½²**: æ»šåŠ¨æ›´æ–°
- **å›æ»šæœºåˆ¶**: 15åˆ†é’Ÿå†…

---

## ğŸ“ æ”¯æŒå’Œç»´æŠ¤

### æŠ€æœ¯æ”¯æŒ
- æ–‡æ¡£: `/docs`
- ç›‘æ§é¢æ¿: Grafana
- å‘Šè­¦é€šçŸ¥: Slack/Email
- æ—¥å¿—æŸ¥çœ‹: ELK Stack

### åº”æ€¥å“åº”
1. **æ•…éšœæ£€æµ‹**: è‡ªåŠ¨å‘Šè­¦
2. **é—®é¢˜è¯Šæ–­**: ç›‘æ§åˆ†æ
3. **å¿«é€Ÿä¿®å¤**: è‡ªåŠ¨åŒ–è„šæœ¬
4. **æ ¹å› åˆ†æ**: æ—¥å¿—åˆ†æ
5. **é¢„é˜²æªæ–½**: é…ç½®ä¼˜åŒ–

---

## ğŸ¯ æ€»ç»“

è¿™å¥—éƒ¨ç½²é…ç½®æ–¹æ¡ˆä¸º HuanuCanvas æä¾›äº†ï¼š

âœ… **å®Œæ•´çš„CI/CDæµæ°´çº¿** - è‡ªåŠ¨åŒ–æµ‹è¯•ã€æ„å»ºã€éƒ¨ç½²  
âœ… **å¤šç¯å¢ƒæ”¯æŒ** - å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒéš”ç¦»  
âœ… **é«˜å¯ç”¨æ¶æ„** - è´Ÿè½½å‡è¡¡ã€è‡ªåŠ¨æ‰©ç¼©å®¹  
âœ… **å…¨é¢ç›‘æ§** - æ€§èƒ½æŒ‡æ ‡ã€ä¸šåŠ¡æŒ‡æ ‡ã€å‘Šè­¦ç³»ç»Ÿ  
âœ… **å®‰å…¨åŠ å›º** - ç½‘ç»œå®‰å…¨ã€åº”ç”¨å®‰å…¨ã€å®¹å™¨å®‰å…¨  
âœ… **å¤‡ä»½æ¢å¤** - æ•°æ®ä¿æŠ¤ã€ç¾éš¾æ¢å¤  
âœ… **è¿ç»´å·¥å…·** - å¥åº·æ£€æŸ¥ã€å¤‡ä»½è„šæœ¬ã€è°ƒè¯•å·¥å…·  

è¯¥æ–¹æ¡ˆæ”¯æŒä»å¼€å‘åˆ°ç”Ÿäº§çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œç¡®ä¿åº”ç”¨çš„ç¨³å®šæ€§ã€å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚