# HuanuCanvas 环境变量配置模板
# 版本: v1.4.1
# 
# 使用方法:
# 1. 复制对应环境的文件: cp .env.development .env.development.local
# 2. 修改其中的值
# 3. 或者创建 .env 文件作为默认配置

# ========================================
# 通用配置 (所有环境通用)
# ========================================

# 环境标识
NODE_ENV=production

# 应用基础信息
APP_NAME=PenguinMagic
APP_VERSION=1.4.1
APP_DESCRIPTION="企鹅工坊 - AI 图像创意管理应用"

# 服务端口配置
FRONTEND_HOST_PORT=80
FRONTEND_SSL_PORT=443
BACKEND_HOST_PORT=8765
PROMETHEUS_HOST_PORT=9090
GRAFANA_HOST_PORT=3000
REDIS_HOST_PORT=6379
POSTGRES_HOST_PORT=5432
NODE_EXPORTER_HOST_PORT=9100
JAEGER_HOST_PORT=16686
JAEGER_AGENT_PORT=14268
LOKI_HOST_PORT=3100

# 域名配置
DOMAIN=localhost
FRONTEND_URL=http://localhost
BACKEND_URL=http://localhost:8765

# ========================================
# 开发环境配置 (.env.development)
# ========================================

# 开发环境特定配置
LOG_LEVEL=debug
HOT_RELOAD=true
SOURCE_MAPS=true

# 开发数据库配置
POSTGRES_DB=huanu_dev
POSTGRES_USER=huanu_dev
POSTGRES_PASSWORD=dev_password_123

# 开发Redis配置
REDIS_PASSWORD=

# 开发监控配置 (默认开启)
GRAFANA_PASSWORD=admin
ENABLE_MONITORING=true

# 开发SSL配置 (使用自签名证书)
SSL_ENABLED=false
SSL_CERT_PATH=./ssl/dev-cert.pem
SSL_KEY_PATH=./ssl/dev-key.pem

# API限流配置 (开发环境较宽松)
MAX_CONCURRENT_REQUESTS=20
RATE_LIMIT_WINDOW=900000
RATE_LIMIT_MAX=200

# 性能配置 (开发环境较低)
MAX_MEMORY_USAGE=512MB
MAX_CPU_USAGE=250m

# 文件上传配置
MAX_FILE_SIZE=50MB
UPLOAD_PATH=./uploads
TEMP_PATH=./temp

# ========================================
# 测试环境配置 (.env.staging)
# ========================================

# 测试环境特定配置
LOG_LEVEL=info
HOT_RELOAD=false
SOURCE_MAPS=false

# 测试数据库配置
POSTGRES_DB=huanu_staging
POSTGRES_USER=huanu_staging
POSTGRES_PASSWORD=staging_password_secure

# 测试Redis配置
REDIS_PASSWORD=staging_redis_password

# 测试监控配置
GRAFANA_PASSWORD=staging_admin_123
ENABLE_MONITORING=true

# 测试SSL配置
SSL_ENABLED=true
SSL_CERT_PATH=./ssl/staging-cert.pem
SSL_KEY_PATH=./ssl/staging-key.pem

# API限流配置 (中等限制)
MAX_CONCURRENT_REQUESTS=15
RATE_LIMIT_WINDOW=900000
RATE_LIMIT_MAX=150

# 性能配置 (中等)
MAX_MEMORY_USAGE=768MB
MAX_CPU_USAGE=375m

# 文件上传配置
MAX_FILE_SIZE=25MB
UPLOAD_PATH=/opt/huanu-canvas/uploads
TEMP_PATH=/opt/huanu-canvas/temp

# ========================================
# 生产环境配置 (.env.production)
# ========================================

# 生产环境特定配置
LOG_LEVEL=warn
HOT_RELOAD=false
SOURCE_MAPS=false

# 生产数据库配置
POSTGRES_DB=huanu_prod
POSTGRES_USER=huanu_prod
POSTGRES_PASSWORD=CHANGE_THIS_TO_SECURE_PASSWORD

# 生产Redis配置
REDIS_PASSWORD=CHANGE_THIS_TO_SECURE_REDIS_PASSWORD

# 生产监控配置
GRAFANA_PASSWORD=CHANGE_THIS_TO_SECURE_GRAFANA_PASSWORD
ENABLE_MONITORING=true

# 生产SSL配置
SSL_ENABLED=true
SSL_CERT_PATH=/etc/ssl/certs/huanu.crt
SSL_KEY_PATH=/etc/ssl/private/huanu.key

# API限流配置 (严格限制)
MAX_CONCURRENT_REQUESTS=10
RATE_LIMIT_WINDOW=900000
RATE_LIMIT_MAX=100

# 性能配置 (高)
MAX_MEMORY_USAGE=1GB
MAX_CPU_USAGE=500m

# 文件上传配置
MAX_FILE_SIZE=10MB
UPLOAD_PATH=/opt/huanu-canvas/uploads
TEMP_PATH=/opt/huanu-canvas/temp

# ========================================
# 密钥配置 (所有环境)
# ========================================

# AI服务密钥 (必需)
GEMINI_API_KEY=YOUR_GEMINI_API_KEY_HERE

# 安全密钥 (必需)
JWT_SECRET=YOUR_JWT_SECRET_HERE_MIN_32_CHARS
SESSION_SECRET=YOUR_SESSION_SECRET_HERE_MIN_32_CHARS

# 数据库连接URL (自动生成，可以手动覆盖)
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}
REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379

# ========================================
# 外部服务配置 (可选)
# ========================================

# 邮件服务配置
SMTP_HOST=
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=noreply@huanu.com

# 错误监控
SENTRY_DSN=
SENTRY_ENVIRONMENT=${NODE_ENV}

# 性能监控
NEW_RELIC_LICENSE_KEY=
NEW_RELIC_APP_NAME=HuanuCanvas

# 文件存储 (可选)
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1
AWS_S3_BUCKET=huanu-files

# CDN配置
CDN_URL=
CDN_API_KEY=

# ========================================
# 安全配置
# ========================================

# CORS配置
ALLOWED_ORIGINS=http://localhost,https://localhost,https://${DOMAIN}
ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With

# 安全头配置
SECURITY_HEADERS_ENABLED=true
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000
CONTENT_SECURITY_POLICY=default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';

# 会话配置
SESSION_TIMEOUT=3600000
SESSION_SECURE=${SSL_ENABLED}
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=strict

# ========================================
# 备份配置
# ========================================

# 数据库备份
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=huanu-backups

# 日志清理
LOG_CLEANUP_ENABLED=true
LOG_CLEANUP_SCHEDULE=0 0 * * 0
LOG_RETENTION_DAYS=7

# ========================================
# 开发工具配置
# ========================================

# 热重载配置
WATCH_PATHS=src,public,assets
WATCH_FILES=true

# 调试配置
DEBUG_MODE=false
DEBUG_MODULES=
PROFILER_ENABLED=false

# 测试配置
TEST_DATABASE_URL=postgresql://${POSTGRES_USER}_test:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}_test
TEST_REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379/1
COVERAGE_THRESHOLD=80

# ========================================
# Docker Compose 特定配置
# ========================================

# Compose项目名称
COMPOSE_PROJECT_NAME=huanu-canvas

# 网络配置
COMPOSE_NETWORK_DRIVER=bridge

# 卷配置
COMPOSE_VOLUME_DRIVER=local

# 服务发现
CONSUL_HOST=
CONSUL_PORT=8500

# ========================================
# Kubernetes 特定配置
# ========================================

# 命名空间
K8S_NAMESPACE=huanu-canvas

# 资源限制
K8S_REQUESTS_CPU=100m
K8S_REQUESTS_MEMORY=256Mi
K8S_LIMITS_CPU=500m
K8S_LIMITS_MEMORY=1Gi

# 健康检查
K8S_HEALTH_CHECK_ENABLED=true
K8S_READINESS_TIMEOUT=30
K8S_LIVENESS_TIMEOUT=30

# 服务网格
ISTIO_ENABLED=false
ISTIO_MTLS=true