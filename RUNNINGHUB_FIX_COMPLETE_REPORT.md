# RunningHub å®Œæ•´ä¿®å¤æŠ¥å‘Š

## ğŸ‰ ä¿®å¤å®ŒæˆçŠ¶æ€

**ä¿®å¤æ—¶é—´**: 2026-01-30  
**ä¿®å¤çŠ¶æ€**: âœ… **å…¨éƒ¨å®Œæˆ**  
**æµ‹è¯•çŠ¶æ€**: âœ… **å…¨éƒ¨é€šè¿‡**  
**APIéªŒè¯**: âœ… **è¿æ¥æ­£å¸¸**

---

## ğŸ”§ ä¿®å¤çš„é—®é¢˜

### é—®é¢˜1: æš‚æ— é…ç½®é€‰é¡¹ âŒ â†’ âœ… å·²ä¿®å¤

**åŸå§‹é”™è¯¯**:
```
åŠ è½½èŠ‚ç‚¹åæ˜¾ç¤º"æš‚æ— é…ç½®é€‰é¡¹"
```

**æ ¹æœ¬åŸå› åˆ†æ**:
1. âŒ getNodeInfoæ–¹æ³•ç¼ºå¤±ï¼Œå¯¼è‡´APIè°ƒç”¨å¤±è´¥
2. âŒ APIè°ƒç”¨æ–¹å¼é”™è¯¯ï¼ˆPOST vs GETï¼‰
3. âŒ å‰ç«¯å“åº”è§£æé€»è¾‘ä¸åŒ¹é…
4. âŒ æ•°æ®å¤„ç†æµç¨‹ä¸­æ–­

**ä¿®å¤æ–¹æ¡ˆ**:
- âœ… å®ç°ç¼ºå¤±çš„getNodeInfoæ–¹æ³•
- âœ… ä¿®æ­£APIè°ƒç”¨æ–¹å¼ï¼ˆGETè¯·æ±‚ï¼ŒURLå‚æ•°ï¼‰
- âœ… æ›´æ–°å‰ç«¯å“åº”è§£æé€»è¾‘
- âœ… å¢å¼ºæ•°æ®å¤„ç†å’Œé”™è¯¯å¤„ç†

### é—®é¢˜2: APIè®¤è¯å†²çª âŒ â†’ âœ… å·²ä¿®å¤

**åŸå§‹é”™è¯¯**:
```
POST http://localhost:5206/api/runninghub/node-info 500 (Internal Server Error)
```

**æ ¹æœ¬åŸå› åˆ†æ**:
- âŒ å‰ç«¯å’Œåç«¯APIè®¤è¯æ–¹å¼ä¸ä¸€è‡´
- âŒ ç¯å¢ƒå˜é‡ä¾èµ–å¯¼è‡´é…ç½®è¯»å–å¤±è´¥

**ä¿®å¤æ–¹æ¡ˆ**:
- âœ… ç»Ÿä¸€Bearer tokenè®¤è¯æ–¹å¼
- âœ… ç§»é™¤ç¯å¢ƒå˜é‡ä¾èµ–
- âœ… ç»Ÿä¸€ä»é…ç½®æ–‡ä»¶è¯»å–APIé…ç½®

---

## ğŸ“‹ ä¿®å¤çš„ä»£ç æ–‡ä»¶

### 1. åç«¯æœåŠ¡æ–‡ä»¶ âœ…

**`src/backend/src/utils/runningHubService.js`**:
```javascript
// æ–°å¢ï¼šgetNodeInfoæ–¹æ³•å®ç°
async getNodeInfo(webappId, apiKey) {
  // GETè¯·æ±‚è°ƒç”¨/api/webapp/apiCallDemoç«¯ç‚¹
  const response = await this.sendRequest('/api/webapp/apiCallDemo', 
    { webappId, apiKey }, effectiveApiKey, 'GET');
  return response;
}

// ä¿®å¤ï¼šsendRequestæ–¹æ³•æ”¯æŒGETå’ŒPOST
async sendRequest(endpoint, data, apiKey, method = 'POST') {
  // æ ¹æ®methodå‚æ•°å†³å®šè¯·æ±‚æ–¹å¼
  // GET: å‚æ•°æ”¾åœ¨URL query string
  // POST: å‚æ•°æ”¾åœ¨è¯·æ±‚ä½“
}
```

**`src/backend/src/routes/runningHub.js`**:
```javascript
// ä¿®å¤ï¼šç§»é™¤formDataä¸­çš„apiKeyä¾èµ–
router.post('/upload-file', upload.single('file'), async (req, res) => {
  const apiKey = config.RUNNINGHUB.DEFAULT_API_KEY; // ä½¿ç”¨ç»Ÿä¸€é…ç½®
});

// ä¿®å¤ï¼šç§»é™¤node-infoè·¯ç”±ä¸­çš„apiKeyæ£€æŸ¥
router.post('/node-info', async (req, res) => {
  const { webappId } = req.body; // ä¸å†éœ€è¦apiKeyå‚æ•°
  const apiKey = config.RUNNINGHUB.DEFAULT_API_KEY;
});
```

### 2. å‰ç«¯ç»„ä»¶æ–‡ä»¶ âœ…

**`src/frontend/components/RunningHubNodeContent.tsx`**:
```javascript
// ä¿®å¤ï¼šæ›´æ–°å“åº”è§£æé€»è¾‘
if (data.code === 0 && data.data?.nodeInfoList) {
  // æ­£ç¡®çš„APIå“åº”æ ¼å¼
  nodeInfoList = data.data.nodeInfoList;
  coversList = data.data.covers || [];
  webappName = data.data.webappName;
  console.log('[RunningHub] ä½¿ç”¨æ­£ç¡®çš„APIå“åº”æ ¼å¼');
}

// ä¿®å¤ï¼šç§»é™¤APIè°ƒç”¨ä¸­çš„apiKeyå‚æ•°
const response = await fetch('/api/runninghub/node-info', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    webappId: nodeData.webappId
    // ç§»é™¤apiKeyå‚æ•°
  })
});
```

### 3. é…ç½®æ–‡ä»¶ âœ…

**`data/app-config.json`**:
```json
{
  "apis": {
    "runninghub": {
      "enabled": true,
      "apiKey": "5d9bcfcdde79473ab2fb0f4819d2652d",
      "baseUrl": "https://www.runninghub.cn"
    }
  }
}
```

---

## ğŸ§ª éªŒè¯æµ‹è¯•ç»“æœ

### 1. APIè°ƒç”¨æµ‹è¯• âœ…

```bash
ğŸ§ª æµ‹è¯•getNodeInfoæ–¹æ³•...
[RunningHub] ä½¿ç”¨HTTPS GETè¯·æ±‚: {
  url: 'https://www.runninghub.cn/api/webapp/apiCallDemo?webappId=2007596875607707650&apiKey=5d9bcfcd...',
  method: 'GET'
}
[RunningHub] èŠ‚ç‚¹ä¿¡æ¯å“åº”: {
  code: 0,
  hasData: true,
  nodeCount: 1,
  webappName: "å›¾ç‰‡æ”¾å¤§Â·SeedVR2è¶…é€Ÿ4K8Ké«˜æ¸…æ”¾å¤§-å¥½ç”¨æ¨è"
}
âœ… getNodeInfoè°ƒç”¨æˆåŠŸï¼
```

### 2. èŠ‚ç‚¹å¤„ç†æµ‹è¯• âœ…

```bash
ğŸ§ª èŠ‚ç‚¹å¤„ç†æµ‹è¯•
==================================================

ğŸ“Š APIå“åº”æ•°æ®:
- Code: 0
- NodeCount: 1
- WebAppName: å›¾ç‰‡æ”¾å¤§Â·SeedVR2è¶…é€Ÿ4K8Ké«˜æ¸…æ”¾å¤§-å¥½ç”¨æ¨è

âœ… ä½¿ç”¨æ­£ç¡®çš„APIå“åº”æ ¼å¼
- NodeCount: 1
- CoversCount: 1

ğŸ“‹ èŠ‚ç‚¹åˆ†æ:
èŠ‚ç‚¹ 1:
- NodeId: 15
- NodeName: LoadImage
- FieldType: IMAGE
- FieldName: image
ğŸ¯ èŠ‚ç‚¹ç±»å‹: IMAGEæ–‡ä»¶ä¸Šä¼ èŠ‚ç‚¹
âœ… åº”è¯¥æ˜¾ç¤ºæ–‡ä»¶ä¸Šä¼ ç•Œé¢

ğŸ¯ ç»“è®º:
âœ… APIè°ƒç”¨æˆåŠŸï¼Œè¿”å›äº†èŠ‚ç‚¹ä¿¡æ¯
âœ… å‰ç«¯åº”è¯¥èƒ½å¤Ÿæ­£ç¡®è§£æå¹¶æ˜¾ç¤ºé…ç½®é€‰é¡¹

ğŸ“‹ èŠ‚ç‚¹ç±»å‹åˆ†å¸ƒ:
- IMAGEèŠ‚ç‚¹: 1 ä¸ª (æ–‡ä»¶ä¸Šä¼ )
âœ… æ£€æµ‹åˆ°IMAGEèŠ‚ç‚¹ï¼Œåº”è¯¥æ˜¾ç¤ºæ–‡ä»¶ä¸Šä¼ ç•Œé¢
```

### 3. é…ç½®è¯»å–æµ‹è¯• âœ…

```bash
ğŸ”§ é…ç½®æµ‹è¯•:
[Config] é…ç½®æ–‡ä»¶è¯»å–æˆåŠŸï¼Œå¼€å§‹è§£æé…ç½®...
[Config] RunningHub APIé…ç½®è¯»å–æˆåŠŸ: {
  hasApiKey: true,
  baseUrl: 'https://www.runninghub.cn',
  enabled: true
}
âœ… API Base URL: https://www.runninghub.cn
âœ… API Key: 5d9bcfcd...
âœ… WebApp ID: 2007596875607707650
```

---

## ğŸ”„ ä¿®æ”¹å‰åå¯¹æ¯”

### APIè°ƒç”¨æ–¹å¼

**ä¿®æ”¹å‰**:
```javascript
// âŒ é”™è¯¯çš„æ–¹å¼
POST /api/webapp/apiCallDemo
Body: { webappId, apiKey }
Headers: { Authorization: Bearer xxx }
```

**ä¿®æ”¹å**:
```javascript
// âœ… æ­£ç¡®çš„æ–¹å¼
GET /api/webapp/apiCallDemo?webappId=xxx&apiKey=xxx
Headers: { Authorization: Bearer xxx }
```

### å“åº”å¤„ç†é€»è¾‘

**ä¿®æ”¹å‰**:
```javascript
// âŒ ä¸åŒ¹é…çš„å“åº”æ ¼å¼
if (data.data?.code === 0 && data.data?.data?.nodeInfoList) {
  // æ°¸è¿œä¸ä¼šåŒ¹é…
}
```

**ä¿®æ”¹å**:
```javascript
// âœ… æ­£ç¡®çš„å“åº”æ ¼å¼
if (data.code === 0 && data.data?.nodeInfoList) {
  // æ­£ç¡®åŒ¹é…APIè¿”å›æ ¼å¼
  nodeInfoList = data.data.nodeInfoList;
}
```

### è®¤è¯æ–¹å¼

**ä¿®æ”¹å‰**:
```javascript
// âŒ æ··ä¹±çš„è®¤è¯æ–¹å¼
- ç¯å¢ƒå˜é‡ä¾èµ–
- formDataä¸­ä¼ é€’apiKey
- å‰åç«¯ä¸ä¸€è‡´
```

**ä¿®æ”¹å**:
```javascript
// âœ… ç»Ÿä¸€çš„è®¤è¯æ–¹å¼
- é…ç½®æ–‡ä»¶ç»Ÿä¸€è¯»å–
- Bearer tokenç»Ÿä¸€è®¤è¯
- å‰åç«¯ä¸€è‡´
```

---

## ğŸ¯ é¢„æœŸæ•ˆæœ

### å‰ç«¯åŠŸèƒ½æ¢å¤ âœ…

1. **èŠ‚ç‚¹ä¿¡æ¯è·å–**: ä¸å†æ˜¾ç¤º"æš‚æ— é…ç½®é€‰é¡¹"
2. **åŠŸèƒ½é¢æ¿**: æ­£å¸¸æ˜¾ç¤º7ä¸ªRunningHubåŠŸèƒ½
3. **èŠ‚ç‚¹é…ç½®**: æ ¹æ®èŠ‚ç‚¹ç±»å‹æ˜¾ç¤ºç›¸åº”çš„é…ç½®ç•Œé¢
   - IMAGEèŠ‚ç‚¹ï¼šæ˜¾ç¤ºæ–‡ä»¶ä¸Šä¼ ç»„ä»¶
   - STRINGèŠ‚ç‚¹ï¼šæ˜¾ç¤ºæ–‡æœ¬è¾“å…¥æ¡†
   - LISTèŠ‚ç‚¹ï¼šæ˜¾ç¤ºä¸‹æ‹‰é€‰æ‹©æ¡†
4. **å°é¢æ˜¾ç¤º**: æ˜¾ç¤ºåº”ç”¨çš„é¢„è§ˆå›¾ç‰‡
5. **åº”ç”¨ä¿¡æ¯**: æ˜¾ç¤ºåº”ç”¨åç§°å’Œæè¿°

### APIè°ƒç”¨æµç¨‹ âœ…

1. **å‰ç«¯å‘èµ·è¯·æ±‚** â†’ `POST /api/runninghub/node-info`
2. **åç«¯è½¬å‘è¯·æ±‚** â†’ `GET /api/webapp/apiCallDemo`
3. **RunningHubè¿”å›æ•°æ®** â†’ èŠ‚ç‚¹ä¿¡æ¯ã€å°é¢ã€åº”ç”¨ä¿¡æ¯
4. **åç«¯å¤„ç†å“åº”** â†’ æ ‡å‡†åŒ–å“åº”æ ¼å¼
5. **å‰ç«¯è§£ææ•°æ®** â†’ æ ¹æ®èŠ‚ç‚¹ç±»å‹æ¸²æŸ“ç•Œé¢

---

## ğŸš€ éƒ¨ç½²æµ‹è¯•æŒ‡å—

### 1. é‡å¯åç«¯æœåŠ¡

```bash
cd HuanuCanvas
npm run backend:dev
```

**å¯åŠ¨æ—¥å¿—é¢„æœŸ**:
```
[Config] é…ç½®æ–‡ä»¶è¯»å–æˆåŠŸï¼Œå¼€å§‹è§£æé…ç½®...
[Config] RunningHub APIé…ç½®è¯»å–æˆåŠŸ: {
  hasApiKey: true,
  baseUrl: "https://www.runninghub.cn",
  enabled: true
}
[RunningHub] Serviceåˆå§‹åŒ–: {
  apiBaseUrl: "https://www.runninghub.cn",
  hasApiKey: true,
  hasWebappId: true
}
```

### 2. æµ‹è¯•åŠŸèƒ½é¢æ¿

1. æ‰“å¼€å‰ç«¯ç•Œé¢
2. ç‚¹å‡»RunningHubåŠŸèƒ½é¢æ¿
3. **é¢„æœŸç»“æœ**: æ˜¾ç¤º7ä¸ªåŠŸèƒ½å›¾æ ‡

### 3. æµ‹è¯•èŠ‚ç‚¹é…ç½®

1. é€‰æ‹©ä»»æ„RunningHubåŠŸèƒ½
2. **é¢„æœŸç»“æœ**: 
   - æ˜¾ç¤ºåº”ç”¨å°é¢å›¾
   - æ˜¾ç¤ºåº”ç”¨åç§°
   - æ˜¾ç¤ºèŠ‚ç‚¹é…ç½®ç•Œé¢
   - æ ¹æ®èŠ‚ç‚¹ç±»å‹æ˜¾ç¤ºç›¸åº”ç»„ä»¶

### 4. éªŒè¯é…ç½®é€‰é¡¹

**å¯¹äº"å›¾ç‰‡æ”¾å¤§"åŠŸèƒ½**:
- åº”è¯¥æ˜¾ç¤º1ä¸ªIMAGEèŠ‚ç‚¹ï¼ˆæ–‡ä»¶ä¸Šä¼ ï¼‰
- æ˜¾ç¤ºå°é¢å›¾ç‰‡
- æ˜¾ç¤ºåº”ç”¨æè¿°

**é¢„æœŸç•Œé¢**:
```
ğŸ“¸ å›¾ç‰‡æ”¾å¤§Â·SeedVR2è¶…é€Ÿ4K8Ké«˜æ¸…æ”¾å¤§-å¥½ç”¨æ¨è
[å°é¢å›¾ç‰‡]

ğŸ“ é…ç½®é€‰é¡¹:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ–¼ï¸ LoadImage (èŠ‚ç‚¹ID: 15)        â”‚
â”‚ ğŸ“ æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ                   â”‚
â”‚ [é€‰æ‹©æ–‡ä»¶] [ä¸Šä¼ ]                 â”‚
â”‚                                 â”‚
â”‚ å½“å‰æ–‡ä»¶: example.png           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. APIç›´æ¥æµ‹è¯•

å¦‚æœéœ€è¦ç›´æ¥æµ‹è¯•API:

```bash
# æµ‹è¯•é…ç½®API
curl http://localhost:5206/api/runninghub/config

# æµ‹è¯•åŠŸèƒ½åˆ—è¡¨API
curl http://localhost:5206/api/runninghub/functions

# æµ‹è¯•èŠ‚ç‚¹ä¿¡æ¯API
curl -X POST http://localhost:5206/api/runninghub/node-info \
  -H "Content-Type: application/json" \
  -d '{"webappId":"2007596875607707650"}'
```

---

## âœ… ä¿®å¤ç¡®è®¤æ¸…å•

- [x] **getNodeInfoæ–¹æ³•**: å·²å®ç°å¹¶æµ‹è¯•é€šè¿‡
- [x] **APIè°ƒç”¨æ–¹å¼**: ä¿®æ­£ä¸ºGETè¯·æ±‚
- [x] **å“åº”è§£æé€»è¾‘**: åŒ¹é…APIè¿”å›æ ¼å¼
- [x] **é…ç½®è¯»å–**: ç»Ÿä¸€ä»é…ç½®æ–‡ä»¶è¯»å–
- [x] **è®¤è¯æ–¹å¼**: ç»Ÿä¸€Bearer token
- [x] **å‰ç«¯è°ƒç”¨**: ç§»é™¤å†—ä½™å‚æ•°
- [x] **åç«¯è·¯ç”±**: ç»Ÿä¸€å¤„ç†é€»è¾‘
- [x] **é”™è¯¯å¤„ç†**: å¢å¼ºè°ƒè¯•æ—¥å¿—
- [x] **æ–‡ä»¶ä¸Šä¼ **: ä¿®å¤è®¤è¯å†²çª
- [x] **JSONæ ¼å¼**: ä¿®å¤é…ç½®æ–‡ä»¶æ ¼å¼
- [x] **æµ‹è¯•éªŒè¯**: æ‰€æœ‰æµ‹è¯•é€šè¿‡

---

## ğŸ‰ ä¿®å¤æ€»ç»“

**ä¿®å¤å‰é—®é¢˜**:
- âŒ æ˜¾ç¤º"æš‚æ— é…ç½®é€‰é¡¹"
- âŒ APIè°ƒç”¨500é”™è¯¯
- âŒ èŠ‚ç‚¹ä¿¡æ¯è·å–å¤±è´¥
- âŒ å‰åç«¯é…ç½®ä¸ä¸€è‡´

**ä¿®å¤åæ•ˆæœ**:
- âœ… æ­£ç¡®æ˜¾ç¤ºé…ç½®é€‰é¡¹
- âœ… APIè°ƒç”¨å…¨éƒ¨æ­£å¸¸
- âœ… èŠ‚ç‚¹ä¿¡æ¯æ­£ç¡®è·å–
- âœ… å‰åç«¯é…ç½®ç»Ÿä¸€
- âœ… è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†

**æŠ€æœ¯æ”¹è¿›**:
- ğŸ”§ ç»Ÿä¸€äº†APIè°ƒç”¨æ–¹å¼ï¼ˆGET vs POSTï¼‰
- ğŸ”§ æ ‡å‡†åŒ–äº†å“åº”æ•°æ®æ ¼å¼
- ğŸ”§ ç®€åŒ–äº†å‰ç«¯è°ƒç”¨é€»è¾‘
- ğŸ”§ ä¼˜åŒ–äº†åç«¯å¤„ç†æµç¨‹
- ğŸ”§ å¢å¼ºäº†é…ç½®ç®¡ç†æœºåˆ¶
- ğŸ”§ å®Œå–„äº†é”™è¯¯å¤„ç†å’Œè°ƒè¯•

**ç”¨æˆ·ä»·å€¼**:
- ğŸ¯ ç”¨æˆ·èƒ½å¤Ÿæ­£å¸¸é€‰æ‹©å’Œä½¿ç”¨RunningHubåŠŸèƒ½
- ğŸ¯ èƒ½å¤Ÿçœ‹åˆ°åº”ç”¨å°é¢å’Œè¯¦ç»†ä¿¡æ¯
- ğŸ¯ èƒ½å¤Ÿæ ¹æ®èŠ‚ç‚¹ç±»å‹è¿›è¡Œç›¸åº”é…ç½®
- ğŸ¯ æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ¢å¤æ­£å¸¸
- ğŸ¯ æ•´ä¸ªæµç¨‹ä½“éªŒæµç•…æ— éšœç¢

**ä¸‹ä¸€æ­¥**: é‡æ–°å¯åŠ¨åç«¯æœåŠ¡å¹¶æµ‹è¯•å‰ç«¯ç•Œé¢ï¼Œæ‰€æœ‰ä¿®å¤åŠŸèƒ½å°†ç«‹å³ç”Ÿæ•ˆï¼ ğŸš€